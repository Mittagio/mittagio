---
description: STOP-ORDER – Legacy-Flow & psheet verboten. Golden Path + Architektur-Blueprint InseratCard (buildListingStep). Gesetz für den Inserat-Flow. [cite: 2026-02-18]
alwaysApply: true
---

# STOP-ORDER: Legacy-Flow & psheet

Es gibt **keinen alten Inseratsflow** mehr. Jede Funktion und jedes UI-Element, das nicht in die **InseratCard** (generiert durch `buildListingStep`) führt, ist **Legacy**.

- **Legacy-Komponenten:** #psheet und openProviderOffer() sind veraltet. Sie dürfen nicht für neue Features verwendet oder in ihrer Logik verstärkt werden.
- **No-Duplicate-UI:** Es gibt keine blauen Balken, separaten Formular-Seiten oder Tabs für das Inserieren. Alles findet innerhalb des **#wizard** statt.
- **Ersatz-Logik:** Bestehende Aufrufe von openProviderOffer(id) sollten perspektivisch durch **startListingFlow({ editOfferId: id })** ersetzt werden, um die InseratCard zu nutzen.

## Der Golden Path (Die einzige Kette)

Jeder Weg zum Inserieren oder Planen folgt diesem Protokoll:

1. **Einstieg:** Dashboard (+), Wochenplan (+) oder Kochbuch-Klick.
2. **Filter (optional):** Das Auswahl-Sheet **#createFlowSheet** (Renner, Neues Gericht, Kochbuch).
3. **Initiator:** openDishFlow() bereitet den Kontext vor und ruft startListingFlow() auf.
4. **Destination:** startListingFlow() öffnet den **#wizard** und lässt **buildListingStep()** die InseratCard rendern.

## Architektur-Blueprint: Die InseratCard

Die InseratCard ist die **einzige** Komponente für alle Zustände. Ihr Aufbau in `buildListingStep()` ist strikt hierarchisch:

| Ebene | Element | Spezifikation |
|-------|---------|---------------|
| 1. Header | Foto-Modul | 190px Höhe, „Foto ändern“-Pill, Smart-Crop (zentriert). |
| 2. Status | Power-Bar | 6 Icons: Vor Ort, Mehrweg, Zeit, Allergene, Extras, Info-Overlay. |
| 3. Fokus | Gerichtsname | Volle Breite, fett, Midnight Blue. Mit Auto-Scaling der Schriftgröße. |
| 4. Sub | Beschreibung | Direkt unter dem Titel als Untertitel, Schiefergrau, kleiner. |
| 5. Action | Kategorie & Preis | Flex-Row: Kategorie-Pills (links), gelber Preis-Button (rechts). |

## Die Modus-Weiche (MODE_AD vs. MODE_PLAN)

Innerhalb der InseratCard steuert der Kontext die Interaktion:

- **MODE_AD (Verkauf):** Zeigt „Preisübersicht“ und die Buttons „mit Abholnummer“ (Grün, 0,89 €) sowie „Nur Inserat“ (Gelb, 4,99 €).
- **MODE_PLAN (Planung):** Blendet Preis-Infos aus. Zeigt Buttons wie „Im Kochbuch speichern“ oder „Einplanen“.

Die Weiche lebt **ausschließlich innerhalb** von `buildListingStep()` – keine separaten Formulare oder Flows.

## Inseratauswahl ist nur Filter

Die Inseratauswahl (#createFlowSheet) entscheidet nur, **mit welchen Daten** die InseratCard geladen wird. Nach der Wahl gibt es nur ein Ziel: die Sammelkarte im **#wizard**. Cursor soll keine alten Formulare suchen; wer nicht `buildListingStep()` nutzt, macht es falsch.

## Warum diese Regel alles ändert

Indem `buildListingStep()` zur **einzigen Wahrheit** erklärt wird, wird die Wartung extrem einfach: Power-Bar, Preis-Button oder Layout-Änderungen passieren **einmal** und gelten überall – Dashboard-Plus, Wochenplan, Kochbuch. Ein Klick, eine Karte, ein Ziel.
