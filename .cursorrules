# Mittagio - Cursor Rules

## Arbeitsverzeichnis (PFLICHT)

- **Alle √Ñnderungen ausschlie√ülich in:** `C:\Users\quach\Documents\GitHub\mittagio` (dieses Repository)
- **Alle anderen Pfade dauerhaft ignorieren** (z. B. andere Workspaces, Obs-Ordner).

## Projekt-√úbersicht

**Mittagio** ist eine digitale Vermittlungs- & Entdeckungsplattform f√ºr strukturierte Mittagstische.

- **Typ:** Single-Page-Application (SPA) in `app/index.html`
- **Deployment:** GitHub Pages (`/mittagio/app/`)
- **Base-Path:** `<base href="/mittagio/app/">`
- **Service Worker:** aktuell deaktiviert (`sw.js.disabled`)

## Wichtigste Projektprinzipien

### Grundprinzip
- **Vermittlungs- & Entdeckungsplattform** (KEIN Marktplatz, KEIN Checkout, KEIN Abo)
- Vertr√§ge entstehen **ausschlie√ülich zwischen Anbieter und Endkunde vor Ort**
- **Keine Mindestlaufzeit, kein Vertrag mit Endkunden**

### Klare Trennung der Bereiche

**Endkundenbereich:**
- √ñffentlich, ohne Login, ohne Profil, ohne Registrierung
- Routen: `/`, `/entdecken`, `/datenschutz`, `/impressum`, `/agb`

**Anbieterbereich:**
- Eigener App-Bereich unter `/anbieter/*`
- Eigene Layout-Shell (Header + Anbieter-BottomNav)
- Routen: `/anbieter/dashboard`, `/anbieter/profil`, `/anbieter/profil/bearbeiten`, `/anbieter/recht/*`, `/anbieter/hilfe`
- `/anbieter` ‚Üí Redirect auf `/anbieter/dashboard`

**‚ùå KEINE Vermischung von Endkunden- & Anbieter-Logik**

## Routing-Regeln

### Logo-Regel
- Klick auf Mittagio-Logo im Anbieterbereich ‚Üí **immer `/anbieter/dashboard`**

### Back-Regel
- ‚ùå **KEIN** Browser-Back (`history.back()`)
- ‚úÖ **Immer explizite In-App-Navigation**
- Fallback immer: `/anbieter/dashboard`

### Dead-Click-Regel (SEHR WICHTIG)
- **Jeder klickbare Button MUSS reagieren**
- Erlaubt: Navigation, Toast/Hinweis
- ‚ùå Verboten: Klick ohne Reaktion

## UI-Texte (VERBINDLICH)

**WICHTIG:** Diese Texte M√úSSEN exakt so verwendet werden. Keine eigenen Erfindungen!

### Endkunden-Dashboard ("Mein Mittagio")
- **Titel:** Dein Mittag in der N√§he
- **Willkommenskarte:**
  - √úberschrift: Willkommen bei Mittagio üëã
  - Text: Finde frische Mittagsangebote in deiner N√§he.
  - Button: Angebote entdecken
- **K√ºrzlich angesehen:** Titel + Button "Angebote ansehen"
- **Anbieter-CTA:**
  - Titel: Als Anbieter starten
  - Text: Mittagtische einfach online anbieten
  - Button: Zum Anbieterbereich

### ‚ùå Verbotene Begriffe (Endkunden)
- Profil anlegen
- Meine Bestellungen
- Zur Mittagsbox
- Bestellen
- Abholcodes, Abholcode, Ticket, Express-Abholung (f√ºr Endkunden)
### ‚úÖ Pflicht (Wording)
- Ausschlie√ülich **Abholnummer** (nie Abholcode, nie Ticket).

### Anbieter-Dashboard
- **Erlaubt:** Inserate, Abholung, Kochbuch, Button "Inserat erstellen"
- **Optional (graue Stepper-Tags):** ‚ûú Inserat erstellen, ‚ûú Gericht w√§hlen, ‚ûú Abholcode (optional)
- **‚ùå Entfernen:** "Willkommen bei Mittagio", "Starte mit deinem ersten Gericht", "Adresse hinzuf√ºgen"

### Rechtstexte
- ‚úÖ Exakt so: AGB, Impressum, Datenschutz
- ‚ùå Nie: AGB-Kurzfassung, Hinweise wie "√∂ffnet dein E-Mail-Programm"

**Vollst√§ndige UI-Texte:** Siehe `docs/texte/ui-texte-mittagio.md`  
**Design-System (STOP & RESET, Polaroid):** Siehe `docs/specs/ui-framework.md`  
**Detailseite Gericht (Schiefertafel, finale Struktur):** Siehe `docs/specs/detailseite-gericht.md`

## Swipe-Modus & 3-S√§ulen-System

### 1. UI-KOMPONENTEN
- Jede Karte folgt dem **Polaroid-Stil** (Wei√üer Hintergrund, handgeschriebener Titel in Marker-Schrift).
- Die **3 S√§ulen Icons** am Kartenrand sind **Pflicht**: üç¥ (Vor Ort), üßæ (Abholnummer), üîÑ (Mehrweg).
- **Keine Begleittexte** f√ºr Icons innerhalb der Karte verwenden.
- **Foto nimmt 50% der Kartenh√∂he ein** (kompakte Sammelkarten-Optik).

### 2. FILTER-LOGIK (HEUTE & N√ÑHE)
- Zeige **nur Gerichte f√ºr den aktuellen Kalendertag** (heute).
- **Standard-Filter:** Gehzeit <= 10 Min (walking distance) - **üë£ 10 min** (Standard-Aktiv).
- **Optionaler Filter:** Fahrzeit <= 15 Min (driving distance) - **üöó 15 min**.
- Nutze **Echtzeit-Routing** basierend auf der Nutzer-Geolocation.
- **Kategorien-Filter:** ü•ó Salat, ü•© Fleisch, etc. (als Pills im Header).

### 3. TERMINOLOGIE (VERBINDLICH)
- ‚ùå **Verbotene W√∂rter:** "Ticket", "Code", "Abholcode", "Vor-Ort Logik".
- ‚úÖ **Erlaubte W√∂rter:** "Abholnummer", "Swipe-Modus".
- Die Funktion hei√üt konsistent **"Swipe-Modus"**.

### 4. INTERAKTION (Aktions-Buttons)
- **Links (Rot):** ‚ùå Verwirft das Gericht (Keine Lust).
- **Mitte (Wei√ü/Blau):** üîÑ Bl√§ttert zum n√§chsten Gericht im Stapel (N√§chstes Gericht).
- **Rechts (Gr√ºn):** ‚ù§Ô∏èüç¥ Speichert Favorit und generiert die Abholnummer (Will ich).

### 5. HEADER & NAVIGATION
- **Zeit-Filter Pills:**
  - üë£ 10 min (Standard-Aktiv f√ºr Fu√üg√§nger)
  - üöó 15 min (Erweiterter Radius)
- **Kategorien-Pills:** ü•ó Salat, ü•© Fleisch, etc.
- **View-Toggle:** Rechts oben (Liste ‚Üî Entdecken).

### 6. DIE 3-S√ÑULEN-REGEL (Emoji-Logik - PFLICHT)
Jede Karte im Swipe-Modus muss **zwingend** diese drei Symbole **ohne begleitenden Text** enthalten:

| Position | Symbol | Bedeutung |
|----------|--------|-----------|
| 1 | üç¥ | Vor Ort (Essen vor Ort m√∂glich) |
| 2 | üßæ | Abholnummer (wird bei Auswahl generiert) |
| 3 | üîÑ | Mehrweg (Nachhaltiges Pfandsystem vorhanden) |

**Wichtig:**
- Die drei Symbole stehen **horizontal in einer Reihe**.
- Slots bleiben fest; bei fehlendem Feature: **Icon ausgegraut** (opacity: 0.4, grayscale(100%)).
- **Kein Wegr√ºcken** der Slots, keine Platzhalter-Boxen.

### 7. SYSTEM-BESCHR√ÑNKUNGEN
- Es darf zu jedem Zeitpunkt **nur eine aktive Sitzung pro Nutzer** existieren.
- ‚ùå Vermeide die "Vor-Ort-Logik" als Begriff in der Nutzerkommunikation.

## Favoriten-Layout (strikt)

**Bei jeder √Ñnderung an der Favoritenseite (`v-fav`) oder an Favoriten-Kacheln:**

- **Mobile First (S25/390px):** Exaktes 2-Spalten-Grid mit **gap: 12px**.
- **Homogenit√§t:** Alle Kacheln im Grid **identische H√∂he**; zu lange Texte mit **ellipsis** k√ºrzen.
- **Header:** Titel "Deine Favoriten f√ºr heute:" und Share-Button in **einer flex-Row** ganz oben.
- **3 S√§ulen:** üç¥, üßæ, üîÑ als gleich gro√üe Icons in einer Reihe **direkt unter dem Bild**; Abholnummer üßæ **Hintergrund #FFD700**.
- **Keine Schiefertafeln:** Nur saubere, abgerundete Karten (**border-radius: 16px**) mit dezentem Schatten; Bild **1:1**.
- **Button:** "In die Mittagsbox" = kompakter, gelber Button am unteren Ende jeder Kachel.

**Vollst√§ndige Regel:** Siehe `docs/FAVORITEN_LAYOUT_REGEL.md`.

## Datenschutz & Endkunden

### Endkunden-Datenschutz
- Gilt f√ºr **Besucher & Endkunden**
- Route: `/datenschutz`
- Keine Registrierung, keine Bestellungen, keine Zahlungen, kein Nutzerkonto
- Kein Marketing-Tracking, keine Werbung
- DSGVO-konform (MVP-Level)

### Erlaubte Endkunden-Daten
- Technisch notwendige Daten
- Standort max. **Stadt / Region**
- Session-basierte Anzeige (z. B. zuletzt angesehen)

### Nicht erlaubt
- Profil anlegen
- "Meine Bestellungen"
- Warenkorb / Box / Checkout
- Abholcodes f√ºr Endkunden
- Personalisierte Nutzerprofile

## Code-Qualit√§t & Standards

### Technische Regeln
- Alle DOM-Zugriffe mit **Null-Checks** absichern
- **Keine `history.back()`** verwenden
- **Immer explizite Navigation**
- Jeder Button muss reagieren (Dead-Click-Regel)
- **Toast statt Alert**: Immer `showToast('Nachricht')` verwenden, nie `alert()`
- **Arbeitsverzeichnis**: Immer in diesem Repository arbeiten (`C:\Users\quach\Documents\GitHub\mittagio`)

### Design-System (Farben & Haptik)
- **Mittagio-Gelb**: `#FFD700` (Sattes, warmes Gelb ‚Äì wie eine frische Kruste)
- **K√ºchen-Anthrazit**: `#121826` (Dunkel, edel, hoher Kontrast)
- **Schatten f√ºr gelbe Buttons**: `box-shadow: 0 25px 50px -12px rgba(255, 215, 0, 0.25)` (Schwebe-Effekt)
- **CSS-Variablen**: `var(--brand)` = `#FFD700`, `var(--border)` f√ºr Rahmen
- **Micro-Interactions**: Buttons mit `transform: scale(0.98)` bei `:active` (0.1s)

### Design-Standards
- **Premium Card-Design**: Horizontales Layout (`.dish-card`, 140px H√∂he)
- **Lucide Icons**: Immer `<i data-lucide="icon-name"></i>` verwenden
- **Nach Rendering**: `lucide.createIcons()` aufrufen
- **Buttons**: Mindesth√∂he 44px (Fat-Finger-Safe), runde Icon-Buttons 34px
- **CTA-Buttons**: `h-16` (64px), `rounded-3xl`, `bg-[#FFD700]`, `text-black`, `font-weight: 900`

### Implementierte Features
- **Tinder-Swipe**: View-Toggle Liste/Swipe, Touch-Gesten, Haptic Feedback, Match Modal
- **Mittagspausen-Timer**: Gehzeit-Berechnung (5 km/h), "Noch X Min zu Fu√ü" Badge
- **Social-Proof**: "Heute schon Xx bestellt" Badge (gelb, users-Icon)
- **Invite-Feature**: "Ich hole mir heute [Gericht] bei [Metzger] ‚Äì kommst du mit?"
- **Skeleton-Screens**: Loading-Placeholder mit pulse-Animation
- **Foto-KI**: Mock GPT-4o Vision API, Auto-Tagging von Allergenen (ohne Mengensch√§tzungen)
- **Ein-Hand-Check-in (USP)**: Gro√üe Abholnummern-Kacheln (72px), Tap-to-Complete, Gr√ºner Flash, Sortierung nach Abholzeit
- **No-Limits Inseratsflow**: Keine Mengenangaben, prominenter "Ausverkauft"/"Noch da" Toggle, active=false Gerichte verschwinden aus Feed

### Projektstruktur
```
mittagio/
‚îú‚îÄ‚îÄ app/                    # Hauptcode (SPA)
‚îÇ   ‚îú‚îÄ‚îÄ index.html         # Single-Page-Application
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json      # PWA Manifest
‚îÇ   ‚îú‚îÄ‚îÄ assets/            # Bilder, Icons
‚îÇ   ‚îî‚îÄ‚îÄ sw.js.disabled     # Service Worker (deaktiviert)
‚îú‚îÄ‚îÄ docs/                  # Konzept, Specs, Kontext
‚îÇ   ‚îú‚îÄ‚îÄ specs/             # Technische Specs (UI-Framework, Detailseite, Swipe, Allergene)
‚îÇ   ‚îú‚îÄ‚îÄ kontext/           # Cursor-Kontext (voll, kurz)
‚îÇ   ‚îú‚îÄ‚îÄ texte/             # Verbindliche UI-Texte (eine Quelle)
‚îÇ   ‚îî‚îÄ‚îÄ analysen/           # Analysen, Fehlerberichte
‚îú‚îÄ‚îÄ tickets/               # Feature-Tickets (A_, B_, C_, D_)
‚îî‚îÄ‚îÄ .cursorrules           # Diese Datei
```

### Wo steht was? (Single Source of Truth)
| Thema | Datei |
|-------|--------|
| Vollst√§ndige Projektzusammenfassung | `docs/kontext/mittagio-voll.md` |
| Kurzfassung Kontext | `docs/kontext/mittagio-kurz.md` |
| Verbindliche UI-Texte | `docs/texte/ui-texte-mittagio.md` |
| Design-System / Polaroid | `docs/specs/ui-framework.md` |
| Detailseite Gericht | `docs/specs/detailseite-gericht.md` |
| Swipe & 3-S√§ulen | `docs/specs/swipe-3saeulen.md` |
| Allergene-Overlay | `docs/specs/allergene-overlay.md` |
| Prompt-Library | `PROMPTS.md` (Root) |

## Golden Rules (f√ºr Cursor)

> Wenn sich etwas **wie ein Shop oder Account** anf√ºhlt ‚Üí **falsch**
> Wenn ein Klick **nichts tut** ‚Üí **nicht done**
> Wenn Endkunde & Anbieter vermischt sind ‚Üí **Bug**

## Empfohlener Cursor-Prompt

**Immer davor schreiben:**
> "Bitte strikt nach der Cursor-Gesamtzusammenfassung Mittagio (Stand 24.01.2026) arbeiten und ausschlie√ülich die verbindlichen UI-Texte verwenden."

## Git & Synchronisation

- Alle √Ñnderungen m√ºssen committed und gepusht werden
- Schnell-Sync: `sync-to-github.bat` (Windows) oder `sync-to-github.sh` (Mac/Linux)
- Siehe `SYNC_CHECKLIST.md` f√ºr Details

---

**Stand:** 28.01.2026  
**Letzte Aktualisierung:** Swipe-Modus Rules finalisiert (Filter-Logik, Zeit-Filter Pills, Aktions-Buttons)
