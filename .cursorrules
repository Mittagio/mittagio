# Mittagio - Cursor Rules

## Arbeitsverzeichnis (PFLICHT)

- **Alle Ã„nderungen ausschlieÃŸlich in:** `C:\Users\quach\Documents\GitHub\mittagio` (dieses Repository)
- **Alle anderen Pfade dauerhaft ignorieren** (z. B. andere Workspaces, Obs-Ordner).

## Projekt-Ãœbersicht

**Mittagio** ist eine digitale Vermittlungs- & Entdeckungsplattform fÃ¼r strukturierte Mittagstische.

- **Typ:** Single-Page-Application (SPA) in `app/index.html`
- **Deployment:** GitHub Pages (`/mittagio/app/`)
- **Base-Path:** `<base href="/mittagio/app/">`
- **Service Worker:** aktuell deaktiviert (`sw.js.disabled`)

## Wichtigste Projektprinzipien

### Grundprinzip
- **Vermittlungs- & Entdeckungsplattform** (KEIN Marktplatz, KEIN Checkout, KEIN Abo)
- VertrÃ¤ge entstehen **ausschlieÃŸlich zwischen Anbieter und Endkunde vor Ort**
- **Keine Mindestlaufzeit, kein Vertrag mit Endkunden**

### Klare Trennung der Bereiche

**Endkundenbereich:**
- Ã–ffentlich, ohne Login, ohne Profil, ohne Registrierung
- Routen: `/`, `/entdecken`, `/datenschutz`, `/impressum`, `/agb`

**Anbieterbereich:**
- Eigener App-Bereich unter `/anbieter/*`
- Eigene Layout-Shell (Header + Anbieter-BottomNav)
- Routen: `/anbieter/dashboard`, `/anbieter/profil`, `/anbieter/profil/bearbeiten`, `/anbieter/recht/*`, `/anbieter/hilfe`
- `/anbieter` â†’ Redirect auf `/anbieter/dashboard`

**âŒ KEINE Vermischung von Endkunden- & Anbieter-Logik**

## Routing-Regeln

### Logo-Regel
- Klick auf Mittagio-Logo im Anbieterbereich â†’ **immer `/anbieter/dashboard`**

### Back-Regel
- âŒ **KEIN** Browser-Back (`history.back()`)
- âœ… **Immer explizite In-App-Navigation**
- Fallback immer: `/anbieter/dashboard`

### Dead-Click-Regel (SEHR WICHTIG)
- **Jeder klickbare Button MUSS reagieren**
- Erlaubt: Navigation, Toast/Hinweis
- âŒ Verboten: Klick ohne Reaktion

## UI-Texte (VERBINDLICH)

**WICHTIG:** Diese Texte MÃœSSEN exakt so verwendet werden. Keine eigenen Erfindungen!

### Endkunden-Dashboard ("Mein Mittagio")
- **Titel:** Dein Mittag in der NÃ¤he
- **Willkommenskarte:**
  - Ãœberschrift: Willkommen bei Mittagio ğŸ‘‹
  - Text: Finde frische Mittagsangebote in deiner NÃ¤he.
  - Button: Angebote entdecken
- **KÃ¼rzlich angesehen:** Titel + Button "Angebote ansehen"
- **Anbieter-CTA:**
  - Titel: Als Anbieter starten
  - Text: Mittagtische einfach online anbieten
  - Button: Zum Anbieterbereich

### âŒ Verbotene Begriffe (Endkunden)
- Profil anlegen
- Meine Bestellungen
- Zur Mittagsbox
- Bestellen
- Abholcodes, Abholcode, Ticket, Express-Abholung (fÃ¼r Endkunden)
### âœ… Pflicht (Wording)
- AusschlieÃŸlich **Abholnummer** (nie Abholcode, nie Ticket).

### Anbieter-Dashboard
- **Erlaubt:** Inserate, Abholung, Kochbuch, Button "Inserat erstellen"
- **Optional (graue Stepper-Tags):** âœ Inserat erstellen, âœ Gericht wÃ¤hlen, âœ Abholcode (optional)
- **âŒ Entfernen:** "Willkommen bei Mittagio", "Starte mit deinem ersten Gericht", "Adresse hinzufÃ¼gen"

### Rechtstexte
- âœ… Exakt so: AGB, Impressum, Datenschutz
- âŒ Nie: AGB-Kurzfassung, Hinweise wie "Ã¶ffnet dein E-Mail-Programm"

**VollstÃ¤ndige UI-Texte:** Siehe `docs/texte/ui-texte-mittagio.md`  
**Design-System (STOP & RESET, Polaroid):** Siehe `docs/specs/ui-framework.md`  
**Detailseite Gericht (Schiefertafel, finale Struktur):** Siehe `docs/specs/detailseite-gericht.md`

## Swipe-Modus & 3-SÃ¤ulen-System

### 1. UI-KOMPONENTEN
- Jede Karte folgt dem **Polaroid-Stil** (WeiÃŸer Hintergrund, handgeschriebener Titel in Marker-Schrift).
- Die **3 SÃ¤ulen Icons** am Kartenrand sind **Pflicht**: ğŸ´ (Vor Ort), ğŸ§¾ (Abholnummer), ğŸ”„ (Mehrweg).
- **Keine Begleittexte** fÃ¼r Icons innerhalb der Karte verwenden.
- **Foto nimmt 50% der KartenhÃ¶he ein** (kompakte Sammelkarten-Optik).

### 2. FILTER-LOGIK (HEUTE & NÃ„HE)
- Zeige **nur Gerichte fÃ¼r den aktuellen Kalendertag** (heute).
- **Standard-Filter:** Gehzeit <= 10 Min (walking distance) - **ğŸ‘£ 10 min** (Standard-Aktiv).
- **Optionaler Filter:** Fahrzeit <= 15 Min (driving distance) - **ğŸš— 15 min**.
- Nutze **Echtzeit-Routing** basierend auf der Nutzer-Geolocation.
- **Kategorien-Filter:** ğŸ¥— Salat, ğŸ¥© Fleisch, etc. (als Pills im Header).

### 3. TERMINOLOGIE (VERBINDLICH)
- âŒ **Verbotene WÃ¶rter:** "Ticket", "Code", "Abholcode", "Vor-Ort Logik".
- âœ… **Erlaubte WÃ¶rter:** "Abholnummer", "Swipe-Modus".
- Die Funktion heiÃŸt konsistent **"Swipe-Modus"**.

### 4. INTERAKTION (Aktions-Buttons)
- **Links (Rot):** âŒ Verwirft das Gericht (Keine Lust).
- **Mitte (WeiÃŸ/Blau):** ğŸ”„ BlÃ¤ttert zum nÃ¤chsten Gericht im Stapel (NÃ¤chstes Gericht).
- **Rechts (GrÃ¼n):** â¤ï¸ğŸ´ Speichert Favorit und generiert die Abholnummer (Will ich).

### 5. HEADER & NAVIGATION
- **Zeit-Filter Pills:**
  - ğŸ‘£ 10 min (Standard-Aktiv fÃ¼r FuÃŸgÃ¤nger)
  - ğŸš— 15 min (Erweiterter Radius)
- **Kategorien-Pills:** ğŸ¥— Salat, ğŸ¥© Fleisch, etc.
- **View-Toggle:** Rechts oben (Liste â†” Entdecken).

### 6. DIE 3-SÃ„ULEN-REGEL (Emoji-Logik - PFLICHT)
Jede Karte im Swipe-Modus muss **zwingend** diese drei Symbole **ohne begleitenden Text** enthalten:

| Position | Symbol | Bedeutung |
|----------|--------|-----------|
| 1 | ğŸ´ | Vor Ort (Essen vor Ort mÃ¶glich) |
| 2 | ğŸ§¾ | Abholnummer (wird bei Auswahl generiert) |
| 3 | ğŸ”„ | Mehrweg (Nachhaltiges Pfandsystem vorhanden) |

**Wichtig:**
- Die drei Symbole stehen **horizontal in einer Reihe**.
- Slots bleiben fest; bei fehlendem Feature: **Icon ausgegraut** (opacity: 0.4, grayscale(100%)).
- **Kein WegrÃ¼cken** der Slots, keine Platzhalter-Boxen.

### 7. SYSTEM-BESCHRÃ„NKUNGEN
- Es darf zu jedem Zeitpunkt **nur eine aktive Sitzung pro Nutzer** existieren.
- âŒ Vermeide die "Vor-Ort-Logik" als Begriff in der Nutzerkommunikation.

## Favoriten-Layout (strikt)

**Bei jeder Ã„nderung an der Favoritenseite (`v-fav`) oder an Favoriten-Kacheln:**

- **Mobile First (S25/390px):** Exaktes 2-Spalten-Grid mit **gap: 12px**.
- **HomogenitÃ¤t:** Alle Kacheln im Grid **identische HÃ¶he**; zu lange Texte mit **ellipsis** kÃ¼rzen.
- **Header:** Titel "Deine Favoriten fÃ¼r heute:" und Share-Button in **einer flex-Row** ganz oben.
- **3 SÃ¤ulen:** ğŸ´, ğŸ§¾, ğŸ”„ als gleich groÃŸe Icons in einer Reihe **direkt unter dem Bild**; Abholnummer ğŸ§¾ **Hintergrund #FFD700**.
- **Keine Schiefertafeln:** Nur saubere, abgerundete Karten (**border-radius: 16px**) mit dezentem Schatten; Bild **1:1**.
- **Button:** "In die Mittagsbox" = kompakter, gelber Button am unteren Ende jeder Kachel.

**VollstÃ¤ndige Regel:** Siehe `docs/FAVORITEN_LAYOUT_REGEL.md`.

## Datenschutz & Endkunden

### Endkunden-Datenschutz
- Gilt fÃ¼r **Besucher & Endkunden**
- Route: `/datenschutz`
- Keine Registrierung, keine Bestellungen, keine Zahlungen, kein Nutzerkonto
- Kein Marketing-Tracking, keine Werbung
- DSGVO-konform (MVP-Level)

### Erlaubte Endkunden-Daten
- Technisch notwendige Daten
- Standort max. **Stadt / Region**
- Session-basierte Anzeige (z. B. zuletzt angesehen)

### Nicht erlaubt
- Profil anlegen
- "Meine Bestellungen"
- Warenkorb / Box / Checkout
- Abholcodes fÃ¼r Endkunden
- Personalisierte Nutzerprofile

## Code-QualitÃ¤t & Standards

### Technische Regeln
- Alle DOM-Zugriffe mit **Null-Checks** absichern
- **Keine `history.back()`** verwenden
- **Immer explizite Navigation**
- Jeder Button muss reagieren (Dead-Click-Regel)
- **Toast statt Alert**: Immer `showToast('Nachricht')` verwenden, nie `alert()`
- **Arbeitsverzeichnis**: Immer in diesem Repository arbeiten (`C:\Users\quach\Documents\GitHub\mittagio`)

### Design-System (Farben & Haptik)
- **Mittagio-Gelb**: `#FFD700` (Sattes, warmes Gelb â€“ wie eine frische Kruste)
- **KÃ¼chen-Anthrazit**: `#121826` (Dunkel, edel, hoher Kontrast)
- **Schatten fÃ¼r gelbe Buttons**: `box-shadow: 0 25px 50px -12px rgba(255, 215, 0, 0.25)` (Schwebe-Effekt)
- **CSS-Variablen**: `var(--brand)` = `#FFD700`, `var(--border)` fÃ¼r Rahmen
- **Micro-Interactions**: Buttons mit `transform: scale(0.98)` bei `:active` (0.1s)

### Design-Standards
- **Premium Card-Design**: Horizontales Layout (`.dish-card`, 140px HÃ¶he)
- **Lucide Icons**: Immer `<i data-lucide="icon-name"></i>` verwenden
- **Nach Rendering**: `lucide.createIcons()` aufrufen
- **Buttons**: MindesthÃ¶he 44px (Fat-Finger-Safe), runde Icon-Buttons 34px
- **CTA-Buttons**: `h-16` (64px), `rounded-3xl`, `bg-[#FFD700]`, `text-black`, `font-weight: 900`

### Implementierte Features
- **Tinder-Swipe**: View-Toggle Liste/Swipe, Touch-Gesten, Haptic Feedback, Match Modal
- **Mittagspausen-Timer**: Gehzeit-Berechnung (5 km/h), "Noch X Min zu FuÃŸ" Badge
- **Social-Proof**: "Heute schon Xx bestellt" Badge (gelb, users-Icon)
- **Invite-Feature**: "Ich hole mir heute [Gericht] bei [Metzger] â€“ kommst du mit?"
- **Skeleton-Screens**: Loading-Placeholder mit pulse-Animation
- **Foto-KI**: Mock GPT-4o Vision API, Auto-Tagging von Allergenen (ohne MengenschÃ¤tzungen)
- **Ein-Hand-Check-in (USP)**: GroÃŸe Abholnummern-Kacheln (72px), Tap-to-Complete, GrÃ¼ner Flash, Sortierung nach Abholzeit
- **No-Limits Inseratsflow**: Keine Mengenangaben, prominenter "Ausverkauft"/"Noch da" Toggle, active=false Gerichte verschwinden aus Feed

### Projektstruktur
```
mittagio/
â”œâ”€â”€ app/                    # Hauptcode (SPA)
â”‚   â”œâ”€â”€ index.html         # Single-Page-Application
â”‚   â”œâ”€â”€ manifest.json      # PWA Manifest
â”‚   â”œâ”€â”€ assets/            # Bilder, Icons
â”‚   â””â”€â”€ sw.js.disabled     # Service Worker (deaktiviert)
â”œâ”€â”€ docs/                  # Konzept, Specs, Kontext
â”‚   â”œâ”€â”€ specs/             # Technische Specs (UI-Framework, Detailseite, Swipe, Allergene)
â”‚   â”œâ”€â”€ kontext/           # Cursor-Kontext (voll, kurz)
â”‚   â”œâ”€â”€ texte/             # Verbindliche UI-Texte (eine Quelle)
â”‚   â””â”€â”€ analysen/           # Analysen, Fehlerberichte
â”œâ”€â”€ tickets/               # Feature-Tickets (A_, B_, C_, D_)
â””â”€â”€ .cursorrules           # Diese Datei
```

### Wo steht was? (Single Source of Truth)
| Thema | Datei |
|-------|--------|
| VollstÃ¤ndige Projektzusammenfassung | `docs/kontext/mittagio-voll.md` |
| Kurzfassung Kontext | `docs/kontext/mittagio-kurz.md` |
| Verbindliche UI-Texte | `docs/texte/ui-texte-mittagio.md` |
| Design-System / Polaroid | `docs/specs/ui-framework.md` |
| Detailseite Gericht | `docs/specs/detailseite-gericht.md` |
| Swipe & 3-SÃ¤ulen | `docs/specs/swipe-3saeulen.md` |
| Allergene-Overlay | `docs/specs/allergene-overlay.md` |
| Prompt-Library | `PROMPTS.md` (Root) |

## Golden Rules (fÃ¼r Cursor)

> Wenn sich etwas **wie ein Shop oder Account** anfÃ¼hlt â†’ **falsch**
> Wenn ein Klick **nichts tut** â†’ **nicht done**
> Wenn Endkunde & Anbieter vermischt sind â†’ **Bug**

## Empfohlener Cursor-Prompt

**Immer davor schreiben:**
> "Bitte strikt nach der Cursor-Gesamtzusammenfassung Mittagio (Stand 24.01.2026) arbeiten und ausschlieÃŸlich die verbindlichen UI-Texte verwenden."

## Git & Synchronisation

- Alle Ã„nderungen mÃ¼ssen committed und gepusht werden
- Schnell-Sync: `sync-to-github.bat` (Windows) oder `sync-to-github.sh` (Mac/Linux)
- Siehe `SYNC_CHECKLIST.md` fÃ¼r Details

## Anbieter: App-First & Wochenplan (Design-Sprache)

### Navigation
- **Bottom-Nav:** Dashboard (KÃ¼che) ganz links, **Wochenplan in der Mitte**, Kochbuch, Meins.
- **Horizontaler Datums-WÃ¤hler:** Oben fixiert, **Snap-Carousel** (physikalisch einrastend), Wochentage Mo, Di, Mi â€¦
- **Thumb Zone:** Teilen, Drucken, HinzufÃ¼gen im unteren Bereich (S25-tauglich).

### Gesten (Wochenplan-Karten)
- **Keine Edit-Stift-Icons:** Tap auf die Karte Ã¶ffnet das Bottom-Sheet (Austauschen/Ersetzen oder Bearbeiten bei Live).
- **Swipe links:** LÃ¶schen â†’ roter Hintergrund, MÃ¼lleimer-Icon.
- **Swipe rechts:** Kopieren auf **Folgetag** â†’ blauer Hintergrund, Duplizieren-Icon (kein Tag-Dialog).

### 3-SÃ¤ulen auf Karten (Inserat/Wochenplan)
- **Feste Status-Badges unter dem Preis:** ğŸ´ (Vor Ort), ğŸ«1ï¸âƒ£ (Abholnummer), ğŸ”„ (Mehrweg).
- **Wording:** Nur **Abholnummer** (nie Ticket, nie Code/Abholcode).

### Monetarisierung & Planung
- **Aktivierung:** 4,99 â‚¬ pro Inserat; Abholnummer optional 0,89 â‚¬ pro Vorgang.
- **Verdienst-Vorschau** in der Planung: Preis âˆ’ GebÃ¼hren = â€Verdienst ca. X â‚¬â€œ auf Entwurfs-Karten.

### Design
- **Keine Schiefertafel:** Clean, modern, hell. Layout fÃ¼r echte Fotos, 3 SÃ¤ulen sauber unter dem Preis.

---

**Stand:** 28.01.2026  
**Letzte Aktualisierung:** App-First/Wochenplan (Gesten, Swipe-Folgetag, Emoji-Badges, Verdienst, Cursor-Regel)
